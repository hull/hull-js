
{{#if errors.conversation}}
  <div class="alert alert-error">Unable to retrieve the conversation</div>
{{else}}
  {{#if conversation}}
    <div class="hull-conversation">
      <div class="hull-conversation__header">
        <h3>{{conversation.name}}</h3>
        {{#if conversation.isDeleteable}}
          <button data-hull-action="deleteConvo" data-hull-id="{{conversation.id}}" class="btn pull-right">Delete conversation</button>
        {{/if}}
      </div>

      {{#if conversation.notification_enabled}}
      <form class="hull-conversation__notifications">
        <input type="checkbox" data-hull-action="notification" name="user_notification" {{#if conversation.notification_enabled_user}}checked{{/if}}> Allow email notifications for this conversation
      </form>
      {{/if}}
  
      <div class="row-fluid">
        <div class="hull-conversation__participants">
          {{> conversation.participants}}
        </div>
      </div>
      <div class="row-fluid">
          {{^isAscending}}
            {{> conversation.form}}
          {{/isAscending}}

          {{#if messages}}
            <ul class="media-list hull-messages__list">
              <div>You have {{conversation.messages_count_unread}} NEW messages and {{conversation.messages_count}} total messages.</div>
              {{#messages}}
                <li class="media" data-hull-message-id="{{id}}">
                  <div class="span2">
                    <span class="pull-right">{{actor.name}}</span>
                  </div>
                  <div class="pull-left">
                    <img class="media-object img-rounded" src="{{actor.picture}}" alt="{{actor.name}}">
                  </div>
                  <div class="media-body">
                    <div class="pull-right">
                      <small class="muted">{{formatTime updated_at "h:mm A"}}</small>
                    </div>
                    <h4 class="media-heading">
                      {{#if isNew}}
                        <small class="text-success">NEW!</small>
                      {{/if}}
                    </h4>
                    <div class="hull-messages__description">
                      {{body}}
                    </div>
                    <div class="hull-messages__actions">
                        {{#if isDeletable}}
                          <small>
                            <a href="#" class='link' data-hull-action="deleteMsg" data-hull-id="{{id}}">Delete</a>
                          </small>
                        {{/if}}
                    </div>
                  </div>
                </li>
              {{/messages}}
            </ul>
          {{/if}}

          {{^messages}}
            <div class="alert alert-info">
              No messages started yet
            </div>
          {{/messages}}

          {{#if isAscending}}
            {{> conversation.form}}
          {{/if}}
      </div>
    </div>
  {{else}}
    <div class="alert alert-info">No conversation selected</div>
  {{/if}}
{{/if}}
